<div class="wrapper">
  <main *ngIf="authService.isLoggedIn; else NotLoggedIn" style="width: 100%;">
    <main *ngIf="this.authService.userData; else Loading" style="width: 100%;">

      <img style="width: 10%; margin: 0 auto;" [src]="this.authService.userData.photoURL!"/>

      <mat-form-field appearance="fill">
        <mat-label>Username</mat-label>
        <input matInput placeholder="Username" [readonly]="!editActive || this.authService.userData.providertype == 'google.com'"
              [(ngModel)]="this.authService.userData.displayName!" [name]="this.authService.userData.displayName!">
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Email</mat-label>
        <input matInput placeholder="Email" [readonly]="!editActive"
        [(ngModel)]="this.authService.userData.email!" [name]="this.authService.userData.email!">
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>First Name</mat-label>
        <input matInput placeholder="First Name" [readonly]="!editActive"
              [(ngModel)]="this.authService.userData.firstName!" [name]="this.authService.userData.firstName!">
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Last Name</mat-label>
        <input matInput placeholder="Last Name" [readonly]="!editActive"
              [(ngModel)]="this.authService.userData.lastName!" [name]="this.authService.userData.lastName!">
      </mat-form-field>



      <table style="text-align: left;">
        <tr>
          <th><h2>Land:</h2></th>
          <th><input [readonly]="!editActive" [(ngModel)]="this.authService.userData.adress.country!"></th>
        </tr>
        <tr>
          <th><h2>Ort:</h2></th>
          <th><input [readonly]="!editActive" [(ngModel)]="this.authService.userData.adress.ort!"></th>
        </tr>
        <tr>
          <th><h2>PLZ:</h2></th>
          <th><input [readonly]="!editActive" [(ngModel)]="this.authService.userData.adress.plz!"></th>
        </tr>
        <tr>
          <th><h2>Stra√üe:</h2></th>
          <th><input [readonly]="!editActive" [(ngModel)]="this.authService.userData.adress.streetName!"></th>
        </tr>
        <tr>
          <th><h2>Nummer:</h2></th>
          <th><input [readonly]="!editActive" [(ngModel)]="this.authService.userData.adress.streetNumber!"></th>
        </tr>
        <tr>
          <th><h2>Email Verified:</h2></th>
          <th>
            <span>
              <mat-icon aria-hidden="false" aria-label="mail verified" *ngIf="this.authService.userData.emailVerified">check_circle</mat-icon>
              <mat-icon aria-hidden="false" aria-label="mail not verified" *ngIf="!this.authService.userData.emailVerified">not_interested</mat-icon>
            </span>
          </th>
          <th><button (click)="this.authService.SendVerificationMail()"
                      [style.display]="(this.authService.userData.providertype != 'google.com' || this.authService.userData.emailVerified == false)?'':'none'"
                      mat-raised-button>Send Verification Mail</button></th>
        </tr>

      </table>

      <button *ngIf="!editActive; else EditActive" (click)="editActive = true" mat-raised-button>Edit</button>

      <ng-template #EditActive>
        <button (click)="resetData(); editActive = false" mat-raised-button>Cancel</button>
        <button (click)="this.authService.SetUserData(this.authService.userData); editActive = false"
                [disabled]="!checkIfUserDataIsCorrect()" mat-raised-button>Save</button>
      </ng-template>
    </main>
  </main>

  <ng-template class="container" #NotLoggedIn>
    <h1>
      Logge dich ein oder registriere dich, um dein Profil einzusehen
    </h1>
    <button routerLink="/login" mat-raised-button mat-button>
      <span>Zum Login</span>
    </button>
  </ng-template>

  <ng-template class="container" #Loading>
    <mat-spinner style="margin: 0 auto;"></mat-spinner>
  </ng-template>
</div>
